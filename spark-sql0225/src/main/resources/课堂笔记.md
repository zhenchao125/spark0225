spark scala 是函数式语言

# 自定义函数

1. 自定义函数
    `spark.udf.register("myToUpper", (s: String) => s.toUpperCase())`

2. 自定义聚合函数
    `sum, avg, count ....`
    
    
# 数据源

## 1. 读
    
### 通用的读

```scala
// 默认是加载 parquet 格式
val df = spark.read.load("路径")

// 向加载 json
val df = spark.read.format("json").load(...)

```    

### 专用的读

```scala
// 专门用来读json
spark.read.json(...)
```


## 2. 写

### 通用的写
    
```scala
val df = ...

// 默认写的是parquet
df.write.save("...")

// 保存json

df.write.format("json").save(...)


```

### 专用的写

```scala
df.write.json(...)
```
    
### saveMOde
    默认: error
    overwrite
    append
    ignore